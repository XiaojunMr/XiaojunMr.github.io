<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      熟练掌握闭包 | 疯狂的码蚁 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="厉害了">
    
    

    <meta name="description" content="对于那些使用不支持闭包特性的编程语言的程序员来说,闭包可能是一个陌生的概念。 初看起来,它们似乎令人生畏。但请放心,付出努力掌握闭包将会给你带来超值的回报。幸运的是,闭包真没有什么可害怕的。理解闭包只需要学会三个基本的事实。第一个事 实:JavaScript 允许你引用在当前函数以外定义的变量。例如：    function makeSandwich(){        var magicIngr">
<meta property="og:type" content="article">
<meta property="og:title" content="熟练掌握闭包 | 疯狂的码蚁">
<meta property="og:url" content="http://yoursite.com/2016/11/26/var/index.html">
<meta property="og:site_name" content="疯狂的码蚁">
<meta property="og:description" content="对于那些使用不支持闭包特性的编程语言的程序员来说,闭包可能是一个陌生的概念。 初看起来,它们似乎令人生畏。但请放心,付出努力掌握闭包将会给你带来超值的回报。幸运的是,闭包真没有什么可害怕的。理解闭包只需要学会三个基本的事实。第一个事 实:JavaScript 允许你引用在当前函数以外定义的变量。例如：    function makeSandwich(){        var magicIngr">
<meta property="og:updated_time" content="2016-11-30T09:50:06.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="熟练掌握闭包 | 疯狂的码蚁">
<meta name="twitter:description" content="对于那些使用不支持闭包特性的编程语言的程序员来说,闭包可能是一个陌生的概念。 初看起来,它们似乎令人生畏。但请放心,付出努力掌握闭包将会给你带来超值的回报。幸运的是,闭包真没有什么可害怕的。理解闭包只需要学会三个基本的事实。第一个事 实:JavaScript 允许你引用在当前函数以外定义的变量。例如：    function makeSandwich(){        var magicIngr">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">疯狂的码蚁</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          人生是 梦的延长
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">档案</a></li>
              
                
                <li class="navigation__item"><a href="/javascript" title="" class="">友情链接</a></li>
              
                
                <li class="navigation__item"><a href="/github" title="" class="">github</a></li>
              
                
                <li class="navigation__item"><a href="/parent_page" title="" class="">个人空间</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">熟练掌握闭包</h1>

    

    <div class="post-meta">
      <time datetime="2016-11-26" class="post-meta__date date">2016-11-26</time> 

      <span class="post-meta__tags tags">

          

          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>对于那些使用不支持闭包特性的编程语言的程序员来说,闭包可能是一个陌生的概念。 初看起来,它们似乎令人生畏。但请放心,付出努力掌握闭包将会给你带来超值的回报。<br>幸运的是,闭包真没有什么可害怕的。理解闭包只需要学会三个基本的事实。第一个事 实:JavaScript 允许你引用在当前函数以外定义的变量。<br>例如：<br>    function makeSandwich(){<br>        var magicIngredient = “疯狂的”;<br>        function make(filling){<br>            return magicIngredient +”and” +filling;<br>        }<br>        return make(“码蚁”);<br>    }<br>    makeSandwich();//疯狂的码蚁</p>
<pre><code>请注意内部的 make 函数是如何引用定义在外部 makeSandwich 函数内的 magicIngredient 变量的。
</code></pre><p>第二个事实:即使外部函数已经返回,当前函数仍然可以引用在外部函数所定义的变量。 如果这听起来让人难以置信,请记住,JavaScript 的函数是第一类(first-class)对象。这意味着,你可以返回一个内部函数,并在稍后调用它。<br>    function sandwichMake(){<br>        var magicIngredient = “疯狂的”;<br>        function make(filling){<br>            return magicIngredient+”and” +filling;<br>        }<br>        return make;<br>    }<br>    var f = sandwichMake();<br>    f(“码蚁”);//疯狂的码蚁<br>    f(“小人物”);//疯狂的小人物</p>
<p>这与第一个例子几乎完全相同。不同的是,不是在外部的 sandwichMaker 函数中立即调 用 make(“码蚁”),而是返回 make 函数本身。因此,f 的值为内部的 make 函数,调用 f 实际 上是调用 make 函数。但即使 sandwichMaker 函数已经返回,make 函数仍能记住 magicIngre- dient 的值。<br>这是如何工作的?<br>答案是: JavaScript 的函数值包含了比调用它们时执行所需要的代码 还要多的信息。而且,JavaScript 函数值还在内部存储它们可能会引用的定义在其封闭作用域 的变量。那些在其所涵盖的作用域内跟踪变量的函数被称为闭包。make 函数就是一个闭包, 其代码引用了两个外部变量:magicIngredient 和 filling。每当 make 函数被调用时,其代码都 能引用到这两个变量,因为该闭包存储了这两个变量。<br>函数可以引用在其作用域内的任何变量,包括参数和外部函数变量。我们可以利用这点 来编写更加通用的 sandwichMaker 函数。<br>    function sandwichMaker(magicIngredient){<br>        function make(filling){<br>            return maficIngredient + “and” +filling;<br>        }<br>        return make<br>    }<br>    var liAnd = sandwichMaker(“li”);<br>    liAnd(“sun”);        //“li and sun”<br>    liAnd(“zhao”);        //“li and zhao”<br>    var funkeyAnd = sandwichMaker(“疯狂的”)；<br>    funkeyAnd （”码蚁”）;        //“疯狂的码蚁”<br>    funkeyAnd  (“小人物”);        //疯狂的小人物</p>
<pre><code>该例子创建了 liAnd 和 funkeyAnd 两个完全不同的函数。尽管它们都是由相同的 make 函数定义的,但是它们是两个截然不同的对象。第一个函数的 magicIngredient 的值为 &quot;li&quot;,而第二个函数的 magicIngredient 的值为 &quot;疯狂的&quot;。
</code></pre><p>闭包是 JavaScript 最优雅、最有表现力的特性之一,也是许多惯用法的核心。JavaScript 甚至还提供了一种更为方便地构建闭包的字面量语法——函数表达式。</p>
<pre><code>function sandwichMake(magicIngredier){
    return function(filling){
        return magicIngredient + &quot;and&quot;+filling;
    }
}
请注意,该函数表达式是匿名的。由于我们只需要其能产生一个新的函数值,而不打 算在局部调用它,因此根本没有必要给该函数命名。函数表达式也可以有名称。
</code></pre><p>学习闭包的第三个也是最后一个事实:闭包可以更新外部变量的值。实际上,闭包存储 的是外部变量的引用,而不是它们的值的副本。因此,对于任何具有访问这些外部变量的闭 包,都可以进行更新。一个简单的惯用法 box 对象说明了这一切。它存储了一个可读写的内 部值。<br>    function box(){<br>        var val = undefined;<br>        reutrn {<br>            set:function(newVal){val = newVal;},<br>            get:function(){return val;},<br>            type:function(){teurn typeof val;}<br>        }<br>    }<br>    var b=box();<br>    b.type();//“undefined”<br>    b.set(98.6);<br>    b.get();//98.6<br>    b.type();//“number”<br>该例子产生了一个包含三个闭包的对象。这三个闭包是 set、get 和 type 属性。它们都共 享访问 val 变量。set 闭包更新 val 的值,随后调用 get 和 type 查看更新的结果。<br>提示<br>❏ 函数可以引用定义在其外部作用域的变量。 ❏ 闭包比创建它们的函数有更长的生命周期。</p>

  </section>

  
  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2016-2017 | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a>欢迎关注个人微博<a href ="http://weibo.com/u/6047911635">你爱的睡宝宝</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
